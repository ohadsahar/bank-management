<mat-form-field id="search">
  <input matInput (keyup)="applyFilter($event.target.value)" placeholder="חיפוש חופשי">
</mat-form-field>

<table mat-table [dataSource]="dataSource" class="mat-elevation-z8" matSort (matSortChange)="sortData($event)">


  <ng-container matColumnDef="id">
    <th mat-header-cell *matHeaderCellDef> <i class="fab fa-cc-visa"></i> אפשרויות </th>
    <td mat-cell *matCellDef="let element; let i = index"> <i class="fas fa-trash"
        (click)="deleteTransaction(element._id, element)"></i>
      <i class="fas fa-edit" (click)="editTransaction(element)" *ngIf="!editEnable"></i>
      <i class="fas fa-check-double" *ngIf="editEnable" (click)="updateTransaction()"></i>
    </td>
  </ng-container>

  <ng-container matColumnDef="cardName">
    <th mat-header-cell *matHeaderCellDef> <i class="fab fa-cc-visa"></i> שם הכרטיס </th>
    <td mat-cell *matCellDef="let element; let i = index">
      <div *ngIf="!editEnable">{{element.cardName}}</div>
      <div *ngIf="editEnable" class="edit-section">
        <mat-form-field class="new-transaction">
          <mat-select [(ngModel)]="bankEditTransaction.cardName" value="{{bankEditTransaction.cardName}}">
            <mat-option value="דרים קארד 3215">דרים קארד 3214</mat-option>
            <mat-option value="דרים קארד 4534">דרים קארד 4534</mat-option>
            <mat-option value="לאומי קארד 8182">לאומי קארד 8182</mat-option>
            <mat-option value="7625 נגב">נגב 7625</mat-option>
            <mat-option value="בנק לאומי 3216">בנק לאומי 3216</mat-option>
            <mat-option value="ויזה 4811">ויזה 4811</mat-option>
            <mat-option value="ויזה 4821">ויזה 4821</mat-option>
          </mat-select>
          <mat-placeholder class="placeholder">שם הכרטיס</mat-placeholder>
          <mat-error>חובה למלא שם כרטיס</mat-error>
        </mat-form-field>
      </div>
    </td>
  </ng-container>
  <!-- Name Column -->
  <ng-container matColumnDef="name">
    <th mat-header-cell *matHeaderCellDef> <i class="fab fa-product-hunt"></i> בית העסק </th>
    <td mat-cell *matCellDef="let element">
      <div *ngIf="!editEnable">{{element.name}}</div>
      <mat-form-field class="new-transaction edit-section" *ngIf="editEnable">
        <input type="text" aria-label="Number" matInput [(ngModel)]="bankEditTransaction.name" [matAutocomplete]="auto"
          value="{{bankEditTransaction.name}}">
        <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
          <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
            {{option}}
          </mat-option>
        </mat-autocomplete>
        <mat-placeholder class="placeholder">בית העסק</mat-placeholder>
        <mat-error>חובה למלא שם מוצר</mat-error>
      </mat-form-field>
    </td>
  </ng-container>
  <!-- Type of product  Column -->
  <ng-container matColumnDef="type">
    <th mat-header-cell *matHeaderCellDef><i class="fas fa-sitemap"></i> קטגוריה </th>
    <td mat-cell *matCellDef="let element">
      <div *ngIf="!editEnable">{{element.typeProduct}} </div>
      <div *ngIf="editEnable">
        <mat-form-field class="new-transaction">
          <mat-select [(ngModel)]="bankEditTransaction.typeProduct" value="bankEditTransaction.typeProduct">
            <mat-option value="חשמל">חשמל</mat-option>
            <mat-option value="ביגוד">ביגוד</mat-option>
            <mat-option value="ריהוט">ריהוט</mat-option>
            <mat-option value="אוכל">אוכל</mat-option>
            <mat-option value="תכשיטים">תכשיטים</mat-option>
            <mat-option value="בריאות">בריאות</mat-option>
            <mat-option value="אחר">אחר</mat-option>
          </mat-select>
          <mat-placeholder class="placeholder">קטגוריה</mat-placeholder>
          <mat-error>חובה למלא את סוג המוצר </mat-error>
        </mat-form-field>
      </div>
    </td>
  </ng-container>
  <!-- Total price Column -->
  <ng-container matColumnDef="price">
    <th mat-sort-header="price" mat-header-cell *matHeaderCellDef> <i class="fas fa-shekel-sign"></i> מחיר כללי </th>
    <td mat-cell *matCellDef="let element">
      <div *ngIf="!editEnable">{{element.price}} </div>
      <div *ngIf="editEnable">
        <mat-form-field class="new-transaction">
          <input matInput type="number" [(ngModel)]="bankEditTransaction.price" value="bankEditTransaction.price"
            required>
          <mat-placeholder class="placeholder">מחיר העסקה</mat-placeholder>
          <mat-error *ngIf="!bankEditTransaction.price">חובה למלא את המחיר הכללי </mat-error>
        </mat-form-field>
      </div>
    </td>
  </ng-container>
  <!-- Payments Column -->
  <ng-container matColumnDef="numberofpayments">
    <th mat-sort-header="numberofpayments" mat-header-cell *matHeaderCellDef> <i class="fas fa-shopping-bag"></i> מספר
      תשלומים </th>
    <td mat-cell *matCellDef="let element">
      <div *ngIf="!editEnable"> {{element.numberofpayments}}</div>
      <div *ngIf="editEnable">
        <mat-form-field class="new-transaction">
    <td><input matInput type="number" [(ngModel)]="bankEditTransaction.numberofpayments"
        (input)="calculateEachMonthEdit()" value="bankEditTransaction.numberOfPayments">
    </td>
    <mat-placeholder class="placeholder">מספר תשלומים</mat-placeholder>
    </mat-form-field>
    </div>
    </td>
  </ng-container>
  <ng-container matColumnDef="eachMonth">
    <th mat-sort-header="eachMonth" mat-header-cell *matHeaderCellDef> <i class="fas fa-cart-arrow-down"></i> תשלום
      חודשי </th>
    <td mat-cell *matCellDef="let element"> <i class="fas fa-shekel-sign"></i> {{element.eachMonth}} </td>
  </ng-container>
  <ng-container matColumnDef="leftPayments">
    <th mat-sort-header="leftPayments" mat-header-cell *matHeaderCellDef><i class="fas fa-trophy"></i> תשלומים שנשארו
    </th>
    <td mat-cell *matCellDef="let element"> {{element.leftPayments}} </td>
  </ng-container>
  <ng-container matColumnDef="purchaseDate">
    <th mat-sort-header="purchaseDate" mat-header-cell *matHeaderCellDef><i class="far fa-calendar-check"></i> תאריך
      קניה</th>
    <td mat-cell *matCellDef="let element"> {{element.purchaseDate}} </td>
  </ng-container>
  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
</table>
<mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
<ng-container>

  <!-- select card field -->
  <div class="input-new-transaction">
    <td>
      <mat-form-field class="new-transaction">
        <mat-select [(ngModel)]="bankTransaction.cardName">
          <mat-option value="דרים קארד 3215">דרים קארד 3214</mat-option>
          <mat-option value="דרים קארד 4534">דרים קארד 4534</mat-option>
          <mat-option value="לאומי קארד 8182">לאומי קארד 8182</mat-option>
          <mat-option value="7625 נגב">נגב 7625</mat-option>
          <mat-option value="בנק לאומי 3216">בנק לאומי 3216</mat-option>
          <mat-option value="ויזה 4811">ויזה 4811</mat-option>
          <mat-option value="ויזה 4821">ויזה 4821</mat-option>
        </mat-select>
        <mat-placeholder class="placeholder">שם הכרטיס</mat-placeholder>
        <mat-error>חובה למלא שם כרטיס</mat-error>
      </mat-form-field>

    </td>
    <td>
      <mat-form-field class="new-transaction">
        <input type="text" aria-label="Number" matInput [formControl]="myControl" [matAutocomplete]="auto">
        <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
          <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
            {{option}}
          </mat-option>
        </mat-autocomplete>
        <mat-placeholder class="placeholder">בית העסק</mat-placeholder>
        <mat-error>חובה למלא שם מוצר</mat-error>
      </mat-form-field>
    </td>
    <td>
      <mat-form-field class="new-transaction">

        <mat-select [(ngModel)]="bankTransaction.typeProduct">
          <mat-option value="חשמל">חשמל</mat-option>
          <mat-option value="ביגוד">ביגוד</mat-option>
          <mat-option value="ריהוט">ריהוט</mat-option>
          <mat-option value="אוכל">אוכל</mat-option>
          <mat-option value="תכשיטים">תכשיטים</mat-option>
          <mat-option value="בריאות">בריאות</mat-option>
          <mat-option value="אחר">אחר</mat-option>
        </mat-select>
        <mat-placeholder class="placeholder">קטגוריה</mat-placeholder>
        <mat-error>חובה למלא את סוג המוצר </mat-error>
      </mat-form-field>
    </td>
    <mat-form-field class="new-transaction">
      <td><input matInput type="number" [(ngModel)]="bankTransaction.price" required></td>
      <mat-placeholder class="placeholder">מחיר העסקה</mat-placeholder>
      <mat-error>חובה למלא את המחיר הכללי </mat-error>
    </mat-form-field>

    <mat-form-field class="new-transaction">
      <td><input matInput type="number" [(ngModel)]="bankTransaction.numberofpayments" (input)="calculateEachMonth()">
      </td>
      <mat-placeholder class="placeholder">מספר תשלומים</mat-placeholder>
    </mat-form-field>

    <mat-form-field class="new-transaction">
      <td><input matInput type="number" [(ngModel)]="bankTransaction.eachMonth" [disabled]="true"></td>
      <mat-placeholder class="placeholder">תשלום חודשי</mat-placeholder>

    </mat-form-field>

    <mat-form-field class="new-transaction">
      <td><input matInput type="number" [(ngModel)]="bankTransaction.leftPayments" [disabled]="true"></td>
      <mat-placeholder class="placeholder">תשלומים שנותרו</mat-placeholder>
    </mat-form-field>
    <td>
      <button mat-raised-button color="primary" type="button" (click)="registerNewTranscation()"
        id="new-transaction-button">אישור</button>
    </td>
  </div>

</ng-container>


<h1>ניתוח מצב פיננסי</h1>

<div>
  <div class="row">
    <div class="col-sm-12 col-md-4 col-lg-6">
      <canvas id="chartDiff">{{chartDiff}}</canvas>
    </div>

  </div>

  <div class="money-management-area">
    <h3 *ngIf="totalExpenses">הוצאות: <i class="fas fa-shekel-sign"></i> {{totalExpenses}}</h3>
    <h3 *ngIf="numberOfPayments">מספר תשלומים כללי: <i class="fas fa-money-check-alt"></i> {{numberOfPayments}}</h3>
    <h3 *ngIf="monthExpenses"> הוצאות קבועות כל חודש: <i class="fas fa-shekel-sign"></i> {{monthExpenses}} </h3>
  </div>
